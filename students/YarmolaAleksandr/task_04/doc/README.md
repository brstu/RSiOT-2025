# Ğ›Ğ°Ğ±Ğ¾Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ½Ğ°Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ° 04: ĞĞ°Ğ±Ğ»ÑĞ´Ğ°ĞµĞ¼Ğ¾ÑÑ‚ÑŒ Ğ¸ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸

**Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚:** Ğ¯Ñ€Ğ¼Ğ¾Ğ»Ğ° ĞĞ»ĞµĞºÑĞ°Ğ½Ğ´Ñ€ ĞĞ»ĞµĞ³Ğ¾Ğ²Ğ¸Ñ‡  
**Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ°:** ĞĞ¡-63  
**StudentID:** 220028  
**Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚:** 23

## ğŸ“‹ ĞœĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ

| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | Ğ—Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ |
|----------|----------|
| **Ğ¤Ğ˜Ğ** | Ğ¯Ñ€Ğ¼Ğ¾Ğ»Ğ° ĞĞ»ĞµĞºÑĞ°Ğ½Ğ´Ñ€ ĞĞ»ĞµĞ³Ğ¾Ğ²Ğ¸Ñ‡ |
| **Ğ“Ñ€ÑƒĞ¿Ğ¿Ğ°** | ĞĞ¡-63 |
| **StudentID** | 220028 |
| **Email** | as006325@g.bstu.by |
| **GitHub username** | alexsandro007 |
| **ĞĞ¾Ğ¼ĞµÑ€ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ğ°** | 23 |

### ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ğ° 23

| ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€ | Ğ—Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|----------|----------|----------|
| **ĞŸÑ€ĞµÑ„Ğ¸ĞºÑ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº** | `app23_` | ĞŸÑ€ĞµÑ„Ğ¸ĞºÑ Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº Prometheus |
| **SLO Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ** | 99.5% | Service Level Objective Ğ¿Ğ¾ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸ |
| **p95 latency** | â‰¤200ms | 95-Ğ¹ Ğ¿ĞµÑ€Ñ†ĞµĞ½Ñ‚Ğ¸Ğ»ÑŒ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ¸ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² |
| **Alert ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ğµ** | 5xx>1% Ğ·Ğ° 5Ğ¼ | ĞĞ»ĞµÑ€Ñ‚ Ğ¿Ñ€Ğ¸ Ğ¿Ñ€ĞµĞ²Ñ‹ÑˆĞµĞ½Ğ¸Ğ¸ 1% Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº 5xx Ğ·Ğ° 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚ |

### ĞĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ğµ

| ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ | Ğ’ĞµÑ€ÑĞ¸Ñ |
|-----------|--------|
| **ĞĞ¡** | Windows 10 Pro Build 19045.6093 |
| **Docker Desktop** | 28.1.1 |
| **kubectl** | v1.32.2 |
| **Minikube** | v1.37.0 |
| **Kubernetes** | v1.34.0 (Ğ² Minikube) |
| **Helm** | v3.16.3 |

---

## ğŸ“‹ ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹

Ğ Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ° Ğ½Ğ° Ğ±Ğ°Ğ·Ğµ **kube-prometheus-stack** (Prometheus + Grafana + Alertmanager) Ğ¸ Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Flask-Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ñ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ°Ğ¼Ğ¸ Prometheus Ğ´Ğ»Ñ Ğ¾Ñ‚ÑĞ»ĞµĞ¶Ğ¸Ğ²Ğ°Ğ½Ğ¸Ñ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸, latency Ğ¸ error rate ÑĞ¾Ğ³Ğ»Ğ°ÑĞ½Ğ¾ SLO Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ğ° 23.

---

## ğŸ“‚ Ğ¡Ñ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

```
task_04/
â”œâ”€â”€ README.md              # ĞšÑ€Ğ°Ñ‚ĞºĞ¾Ğµ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ
â”œâ”€â”€ doc/
â”‚   â””â”€â”€ README.md          # ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ¾Ñ‚Ñ‡ĞµÑ‚ (ÑÑ‚Ğ¾Ñ‚ Ñ„Ğ°Ğ¹Ğ»)
â””â”€â”€ src/
    â”œâ”€â”€ app/               # ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ñ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ°Ğ¼Ğ¸
    â”‚   â”œâ”€â”€ app.py         # Flask Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ
    â”‚   â”œâ”€â”€ Dockerfile     # Docker Ğ¾Ğ±Ñ€Ğ°Ğ·
    â”‚   â””â”€â”€ requirements.txt
    â”œâ”€â”€ k8s/               # Kubernetes Ğ¼Ğ°Ğ½Ğ¸Ñ„ĞµÑÑ‚Ñ‹
    â”‚   â””â”€â”€ install.sh     # Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸
    â””â”€â”€ helm/              # Helm chart
        â””â”€â”€ monitoring-app/
            â”œâ”€â”€ Chart.yaml
            â”œâ”€â”€ values.yaml
            â””â”€â”€ templates/
                â”œâ”€â”€ _helpers.tpl
                â”œâ”€â”€ deployment.yaml
                â”œâ”€â”€ service.yaml
                â”œâ”€â”€ servicemonitor.yaml
                â””â”€â”€ prometheusrule.yaml
```

---

## ğŸ—ï¸ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Namespace: monitoring                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ kube-prometheus-stack                                      â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚ â”‚  Prometheus  â”‚  â”‚   Grafana    â”‚  â”‚  Alertmanager    â”‚ â”‚ â”‚
â”‚  â”‚ â”‚              â”‚  â”‚              â”‚  â”‚                  â”‚ â”‚ â”‚
â”‚  â”‚ â”‚ Port: 9090   â”‚  â”‚ Port: 3000   â”‚  â”‚  Port: 9093      â”‚ â”‚ â”‚
â”‚  â”‚ â”‚              â”‚  â”‚              â”‚  â”‚                  â”‚ â”‚ â”‚
â”‚  â”‚ â”‚ - Scrapes    â”‚  â”‚ - Dashboards â”‚  â”‚  - Routing       â”‚ â”‚ â”‚
â”‚  â”‚ â”‚   metrics    â”‚  â”‚ - Queries    â”‚  â”‚  - Notifications â”‚ â”‚ â”‚
â”‚  â”‚ â”‚ - Rules      â”‚  â”‚ - Alerts     â”‚  â”‚                  â”‚ â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚            â”‚                                                      â”‚
â”‚            â”‚ ServiceMonitor (ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 30s)                         â”‚
â”‚            â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Namespace: monitoring-app                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Deployment: monitoring-app (2 replicas)                    â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚ â”‚
â”‚  â”‚ â”‚ Pod 1              â”‚  â”‚ Pod 2              â”‚           â”‚ â”‚
â”‚  â”‚ â”‚ Flask App          â”‚  â”‚ Flask App          â”‚           â”‚ â”‚
â”‚  â”‚ â”‚ + Prometheus clientâ”‚  â”‚ + Prometheus clientâ”‚           â”‚ â”‚
â”‚  â”‚ â”‚                    â”‚  â”‚                    â”‚           â”‚ â”‚
â”‚  â”‚ â”‚ Endpoints:         â”‚  â”‚ Endpoints:         â”‚           â”‚ â”‚
â”‚  â”‚ â”‚ /                  â”‚  â”‚ /                  â”‚           â”‚ â”‚
â”‚  â”‚ â”‚ /health            â”‚  â”‚ /health            â”‚           â”‚ â”‚
â”‚  â”‚ â”‚ /api/data          â”‚  â”‚ /api/data          â”‚           â”‚ â”‚
â”‚  â”‚ â”‚ /api/slow          â”‚  â”‚ /api/slow          â”‚           â”‚ â”‚
â”‚  â”‚ â”‚ /api/error         â”‚  â”‚ /api/error         â”‚           â”‚ â”‚
â”‚  â”‚ â”‚ /metrics â† â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â”‚  ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ñ Ğ¿Ñ€ĞµÑ„Ğ¸ĞºÑĞ¾Ğ¼ app23_:                                    â”‚
â”‚  â€¢ app23_http_requests_total{method,endpoint,status}            â”‚
â”‚  â€¢ app23_http_request_duration_seconds{method,endpoint}         â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ PrometheusRule: Alerts                                     â”‚ â”‚
â”‚  â”‚ â”œâ”€ LowAvailability (availability < 99.5%)                  â”‚ â”‚
â”‚  â”‚ â”œâ”€ HighErrorRate5xx (5xx errors > 1% for 5m)              â”‚ â”‚
â”‚  â”‚ â””â”€ HighLatencyP95 (p95 latency > 200ms for 5m)            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¸ Ñ€Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ

### Ğ¨Ğ°Ğ³ 1: ĞŸĞ¾Ğ´Ğ³Ğ¾Ñ‚Ğ¾Ğ²ĞºĞ° ĞºĞ»Ğ°ÑÑ‚ĞµÑ€Ğ°

```bash
# Ğ—Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ Minikube
minikube start --cpus=4 --memory=8192 --driver=docker

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ
kubectl cluster-info
```

### Ğ¨Ğ°Ğ³ 2: Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° kube-prometheus-stack

```powershell
# Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Helm Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹
$env:Path = "$env:LOCALAPPDATA\helm;$env:Path"
helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
helm repo update

# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ monitoring stack
helm install monitoring prometheus-community/kube-prometheus-stack `
  --namespace monitoring `
  --create-namespace `
  --set prometheus.prometheusSpec.serviceMonitorSelectorNilUsesHelmValues=false `
  --set prometheus.prometheusSpec.podMonitorSelectorNilUsesHelmValues=false `
  --set prometheus.prometheusSpec.ruleSelectorNilUsesHelmValues=false

# Ğ”Ğ¾Ğ¶Ğ´Ğ°Ñ‚ÑŒÑÑ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸ (5-10 Ğ¼Ğ¸Ğ½ÑƒÑ‚)
kubectl wait --for=condition=ready pod -l app.kubernetes.io/name=grafana `
  -n monitoring --timeout=600s
```

### Ğ¨Ğ°Ğ³ 3: Ğ¡Ğ±Ğ¾Ñ€ĞºĞ° Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ° Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ

```powershell
# ĞŸĞµÑ€ĞµĞ¹Ñ‚Ğ¸ Ğ² Ğ¿Ğ°Ğ¿ĞºÑƒ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
cd src/app

# Ğ¡Ğ¾Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ¾Ğ±Ñ€Ğ°Ğ· Ğ² Minikube
minikube docker-env --shell powershell | Invoke-Expression
docker build -t monitoring-app:latest .

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ¾Ğ±Ñ€Ğ°Ğ·
docker images | Select-String monitoring-app
```

### Ğ¨Ğ°Ğ³ 4: Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· Helm

```powershell
# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ chart
helm install monitoring-app ./src/helm/monitoring-app `
  --namespace monitoring-app `
  --create-namespace

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ€Ğ°Ğ·Ğ²ĞµÑ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ
kubectl get all -n monitoring-app
kubectl get servicemonitor,prometheusrule -n monitoring-app
```

### Ğ¨Ğ°Ğ³ 5: ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑĞ±Ğ¾Ñ€Ğ° Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº

```bash
# Port-forward Ğº Prometheus
kubectl port-forward svc/monitoring-kube-prometheus-prometheus 9090:9090 -n monitoring

# ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ğ² Ğ±Ñ€Ğ°ÑƒĞ·ĞµÑ€Ğµ: http://localhost:9090
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸: app23_http_requests_total, app23_http_request_duration_seconds
```

### Ğ¨Ğ°Ğ³ 6: Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Grafana

```powershell
# Port-forward Ğº Grafana
kubectl port-forward svc/monitoring-grafana 3000:80 -n monitoring

# ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑŒ
$pass = kubectl get secret monitoring-grafana -n monitoring -o jsonpath='{.data.admin-password}'
[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($pass))

# ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ: http://localhost:3000
# Login: admin
# Password: (Ğ¸Ğ· ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ Ğ²Ñ‹ÑˆĞµ)
```

---

## ğŸ“Š ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ

### ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ñ Ğ¿Ñ€ĞµÑ„Ğ¸ĞºÑĞ¾Ğ¼ `app23_`

| ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ° | Ğ¢Ğ¸Ğ¿ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|---------|-----|----------|
| `app23_http_requests_total` | Counter | ĞĞ±Ñ‰ĞµĞµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ HTTP Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² |
| `app23_http_request_duration_seconds` | Histogram | Ğ“Ğ¸ÑÑ‚Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ° Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ¸ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² |

### Labels

| Label | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ—Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ |
|-------|----------|----------|
| `method` | HTTP Ğ¼ĞµÑ‚Ğ¾Ğ´ | GET, POST, PUT, DELETE |
| `endpoint` | Endpoint Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ | /, /health, /api/data, /api/error, /api/slow |
| `status` | HTTP status code | 200, 404, 500, etc. |

### ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ PromQL Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²

#### 1. Rate Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²

```promql
# Ğ—Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ² ÑĞµĞºÑƒĞ½Ğ´Ñƒ
rate(app23_http_requests_total[5m])

# ĞŸĞ¾ endpoint
sum(rate(app23_http_requests_total[5m])) by (endpoint)
```

#### 2. Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ (SLO 99.5%)

```promql
# ĞŸÑ€Ğ¾Ñ†ĞµĞ½Ñ‚ ÑƒÑĞ¿ĞµÑˆĞ½Ñ‹Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
(
  sum(rate(app23_http_requests_total{status!~"5.."}[5m]))
  /
  sum(rate(app23_http_requests_total[5m]))
) * 100
```

#### 3. Latency p95 (SLO â‰¤200ms)

```promql
# 95-Ğ¹ Ğ¿ĞµÑ€Ñ†ĞµĞ½Ñ‚Ğ¸Ğ»ÑŒ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ¸
histogram_quantile(0.95,
  sum(rate(app23_http_request_duration_seconds_bucket[5m])) by (le)
)
```

#### 4. Error rate 5xx (Alert >1%)

```promql
# ĞŸÑ€Ğ¾Ñ†ĞµĞ½Ñ‚ 5xx Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
(
  sum(rate(app23_http_requests_total{status=~"5.."}[5m]))
  /
  sum(rate(app23_http_requests_total[5m]))
) * 100
```

---

## ğŸ“ˆ Dashboards Ğ² Grafana

### Dashboard 1: Availability (Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ)

**ĞŸĞ°Ğ½ĞµĞ»Ğ¸:**

1. **SLO Gauge** - Ñ‚ĞµĞºÑƒÑ‰Ğ°Ñ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ Ñ Ğ¿Ğ¾Ñ€Ğ¾Ğ³Ğ¾Ğ¼ 99.5%
2. **Availability Timeline** - Ğ³Ñ€Ğ°Ñ„Ğ¸Ğº Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ·Ğ° Ğ²Ñ€ĞµĞ¼Ñ
3. **Success/Error Rate** - ÑĞ¾Ğ¾Ñ‚Ğ½Ğ¾ÑˆĞµĞ½Ğ¸Ğµ ÑƒÑĞ¿ĞµÑˆĞ½Ñ‹Ñ… Ğ¸ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ñ‡Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²

**PromQL Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹:**

```promql
# Gauge - Ñ‚ĞµĞºÑƒÑ‰Ğ°Ñ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ
(sum(rate(app23_http_requests_total{status!~"5.."}[5m]))
/ sum(rate(app23_http_requests_total[5m]))) * 100

# Graph - Timeline
(sum(rate(app23_http_requests_total{status!~"5.."}[1m]))
/ sum(rate(app23_http_requests_total[1m]))) * 100
```

### Dashboard 2: Latency (Ğ—Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ°)

**ĞŸĞ°Ğ½ĞµĞ»Ğ¸:**

1. **p50, p95, p99 Latency** - Ğ¿ĞµÑ€Ñ†ĞµĞ½Ñ‚Ğ¸Ğ»Ğ¸ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ¸
2. **Latency Heatmap** - Ñ‚ĞµĞ¿Ğ»Ğ¾Ğ²Ğ°Ñ ĞºĞ°Ñ€Ñ‚Ğ° Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ
3. **SLO p95 Status** - ÑÑ‚Ğ°Ñ‚ÑƒÑ ÑĞ¾Ğ±Ğ»ÑĞ´ĞµĞ½Ğ¸Ñ SLO â‰¤200ms

**PromQL Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹:**

```promql
# p95
histogram_quantile(0.95,
  sum(rate(app23_http_request_duration_seconds_bucket[5m])) by (le))

# p99
histogram_quantile(0.99,
  sum(rate(app23_http_request_duration_seconds_bucket[5m])) by (le))

# Heatmap
sum(rate(app23_http_request_duration_seconds_bucket[5m])) by (le)
```

### Dashboard 3: Errors (ĞÑˆĞ¸Ğ±ĞºĞ¸)

**ĞŸĞ°Ğ½ĞµĞ»Ğ¸:**

1. **5xx Error Rate** - Ğ¿Ñ€Ğ¾Ñ†ĞµĞ½Ñ‚ 5xx Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
2. **Errors by Endpoint** - Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ Ğ¿Ğ¾ endpoint
3. **Total Errors** - Ğ¾Ğ±Ñ‰ĞµĞµ ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº

**PromQL Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹:**

```promql
# Error rate %
(sum(rate(app23_http_requests_total{status=~"5.."}[5m]))
/ sum(rate(app23_http_requests_total[5m]))) * 100

# By endpoint
sum(rate(app23_http_requests_total{status=~"5.."}[5m])) by (endpoint)

# Total errors
sum(increase(app23_http_requests_total{status=~"5.."}[1h]))
```

---

## ğŸš¨ Alerts (ĞĞ»ĞµÑ€Ñ‚Ñ‹)

### Alert 1: LowAvailability

**Ğ£ÑĞ»Ğ¾Ğ²Ğ¸Ğµ:** Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ < 99.5% Ğ² Ñ‚ĞµÑ‡ĞµĞ½Ğ¸Ğµ 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚

```yaml
- alert: LowAvailability
  expr: |
    (sum(rate(app23_http_requests_total{status!~"5.."}[5m]))
    / sum(rate(app23_http_requests_total[5m]))) * 100 < 99.5
  for: 5m
  labels:
    severity: critical
    variant: "23"
  annotations:
    summary: "Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ Ğ½Ğ¸Ğ¶Ğµ SLO 99.5%"
    description: "Ğ¢ĞµĞºÑƒÑ‰Ğ°Ñ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ {{ $value }}% (Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ â‰¥99.5%)"
```

**ĞšĞ¾Ğ³Ğ´Ğ° ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚:**

- ĞœĞ°ÑÑĞ¾Ğ²Ñ‹Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ 5xx
- ĞĞµĞ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ ÑĞµÑ€Ğ²Ğ¸ÑĞ°
- ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ Ñ pod'Ğ°Ğ¼Ğ¸

### Alert 2: HighErrorRate5xx

**Ğ£ÑĞ»Ğ¾Ğ²Ğ¸Ğµ:** 5xx Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº > 1% Ğ·Ğ° 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚ (ÑĞ¾Ğ³Ğ»Ğ°ÑĞ½Ğ¾ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ñƒ 23)

```yaml
- alert: HighErrorRate5xx
  expr: |
    (sum(rate(app23_http_requests_total{status=~"5.."}[5m]))
    / sum(rate(app23_http_requests_total[5m]))) * 100 > 1
  for: 5m
  labels:
    severity: warning
    variant: "23"
  annotations:
    summary: "ĞŸÑ€Ğ¾Ñ†ĞµĞ½Ñ‚ 5xx Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº Ğ¿Ñ€ĞµĞ²Ñ‹ÑˆĞ°ĞµÑ‚ 1%"
    description: "5xx Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº: {{ $value }}% Ğ·Ğ° Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚ (Ğ¿Ğ¾Ñ€Ğ¾Ğ³ >1%)"
```

**ĞšĞ¾Ğ³Ğ´Ğ° ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚:**

- Endpoint `/api/error` Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº 500
- ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ Ñ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸ĞµĞ¼
- ĞĞ°Ğ³Ñ€ÑƒĞ·Ğ¾Ñ‡Ğ½Ğ¾Ğµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### Alert 3: HighLatencyP95

**Ğ£ÑĞ»Ğ¾Ğ²Ğ¸Ğµ:** p95 latency > 200ms Ğ² Ñ‚ĞµÑ‡ĞµĞ½Ğ¸Ğµ 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚

```yaml
- alert: HighLatencyP95
  expr: |
    histogram_quantile(0.95,
      sum(rate(app23_http_request_duration_seconds_bucket[5m])) by (le)) > 0.2
  for: 5m
  labels:
    severity: warning
    variant: "23"
  annotations:
    summary: "p95 latency Ğ¿Ñ€ĞµĞ²Ñ‹ÑˆĞ°ĞµÑ‚ 200ms"
    description: "p95 latency: {{ $value }}s (Ñ‚Ñ€ĞµĞ±ÑƒĞµÑ‚ÑÑ â‰¤0.2s)"
```

**ĞšĞ¾Ğ³Ğ´Ğ° ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚:**

- Endpoint `/api/slow` Ñ Ğ·Ğ°Ğ´ĞµÑ€Ğ¶ĞºĞ¾Ğ¹ 200-400ms
- Ğ’Ñ‹ÑĞ¾ĞºĞ°Ñ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°
- ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒÑ

---

## ğŸ§ª Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ´ĞµĞ¼Ğ¾Ğ½ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ

### Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸

```bash
# Port-forward Ğº Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
kubectl port-forward svc/monitoring-app 8080:80 -n monitoring-app

# Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸
while true; do curl -s http://localhost:8080/api/data > /dev/null; sleep 0.1; done

# Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² (trigger HighLatencyP95)
while true; do curl -s http://localhost:8080/api/slow > /dev/null; sleep 0.5; done

# Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº (trigger HighErrorRate5xx)
while true; do curl -s http://localhost:8080/api/error > /dev/null; sleep 0.1; done
```

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ°Ğ»ĞµÑ€Ñ‚Ğ¾Ğ²

```bash
# ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Prometheus Alerts
# http://localhost:9090/alerts

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ‚ÑƒÑ Ñ‡ĞµÑ€ĞµĞ· kubectl
kubectl get prometheusrules -n monitoring-app

# Ğ›Ğ¾Ğ³Ğ¸ Alertmanager
kubectl logs -l app.kubernetes.io/name=alertmanager -n monitoring --tail=100
```

---

## ğŸ“„ Helm Chart

### ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ values.yaml

```yaml
# Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 23
replicaCount: 2

metrics:
  prefix: "app23_"
  slo:
    availability: 99.5
    latencyP95: 0.2
    errorRate5xx: 1

student:
  id: "220028"
  group: "ĞĞ¡-63"
  variant: "23"

serviceMonitor:
  enabled: true
  interval: 30s
  labels:
    release: monitoring

prometheusRule:
  enabled: true
  labels:
    release: monitoring
```

### Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ¸ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ

```powershell
# Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°
helm install monitoring-app ./src/helm/monitoring-app `
  --namespace monitoring-app `
  --create-namespace

# ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
helm upgrade monitoring-app ./src/helm/monitoring-app `
  --namespace monitoring-app

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°
helm lint ./src/helm/monitoring-app
helm template monitoring-app ./src/helm/monitoring-app

# Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ
helm uninstall monitoring-app -n monitoring-app
```

---

## âœ… ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¸ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ

| ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¹ | Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|----------|--------|----------|
| ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ ÑĞ¾Ğ±Ğ¸Ñ€Ğ°ÑÑ‚ÑÑ | âœ… | ServiceMonitor Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚, Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ app23_* Ğ² Prometheus |
| Ğ”Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ñ‹ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ñ‹ | âœ… | 3 Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ğ°: Availability, Latency, Errors |
| ĞĞ»ĞµÑ€Ñ‚Ñ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ÑÑ‚ | âœ… | 3 Ğ°Ğ»ĞµÑ€Ñ‚Ğ°: LowAvailability, HighErrorRate5xx, HighLatencyP95 |
| Helm chart Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¸Ñ‚ÑÑ | âœ… | Chart Ñ values, templates, _helpers.tpl |
| SLO ÑĞ¾Ğ±Ğ»ÑĞ´ĞµĞ½Ñ‹ | âœ… | 99.5% availability, p95â‰¤200ms, 5xx<1% |
| Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ | âœ… | Ğ¡Ñ…ĞµĞ¼Ğ° Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°, ÑĞºÑ€Ğ¸Ğ½ÑˆĞ¾Ñ‚Ñ‹, Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ğ¸ |

---

## ğŸ”§ ĞŸĞ¾Ğ»ĞµĞ·Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹

```powershell
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº
kubectl port-forward svc/monitoring-app 8080:80 -n monitoring-app
Invoke-WebRequest http://localhost:8080/metrics -UseBasicParsing

# Prometheus UI
kubectl port-forward svc/monitoring-kube-prometheus-prometheus 9090:9090 -n monitoring

# Grafana UI
kubectl port-forward svc/monitoring-grafana 3000:80 -n monitoring

# Ğ›Ğ¾Ğ³Ğ¸ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
kubectl logs -f -l app=monitoring-app -n monitoring-app

# Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ğ°Ğ»ĞµÑ€Ñ‚Ğ¾Ğ²
kubectl get prometheusrules -n monitoring-app -o yaml

# Restart Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ
kubectl rollout restart deployment/monitoring-app -n monitoring-app
```

---

## ğŸ“ Ğ’Ñ‹Ğ²Ğ¾Ğ´Ñ‹

### Ğ§Ñ‚Ğ¾ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¾

1. âœ… **kube-prometheus-stack** ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½ Ğ¸ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
2. âœ… **Flask Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ** Ñ endpoint `/metrics` Ğ¸ Ğ¿Ñ€ĞµÑ„Ğ¸ĞºÑĞ¾Ğ¼ `app23_`
3. âœ… **ServiceMonitor** Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ ÑĞ¾Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 30 ÑĞµĞºÑƒĞ½Ğ´
4. âœ… **3 Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ğ°** Ğ² Grafana: Availability, Latency, Errors
5. âœ… **3 Ğ°Ğ»ĞµÑ€Ñ‚Ğ°** Ğ¿Ğ¾ SLO Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ğ° 23:
   - LowAvailability (< 99.5%)
   - HighErrorRate5xx (> 1% Ğ·Ğ° 5Ğ¼)
   - HighLatencyP95 (> 200ms Ğ·Ğ° 5Ğ¼)
6. âœ… **Helm chart** Ñ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹ Ñ‡ĞµÑ€ĞµĞ· values.yaml
7. âœ… **ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ** Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ¾Ğ¹ Ğ¸ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸ÑĞ¼Ğ¸

### Ğ”Ğ¾ÑÑ‚Ğ¸Ğ³Ğ½ÑƒÑ‚Ñ‹Ğµ SLO

- **Ğ”Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚ÑŒ:** 99.5% Ğ¿Ñ€Ğ¸ Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞµ
- **p95 latency:** 50-150ms Ğ´Ğ»Ñ `/api/data`, 200-350ms Ğ´Ğ»Ñ `/api/slow`
- **Error rate:** < 1% Ğ¿Ñ€Ğ¸ Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğµ, > 1% Ğ¿Ñ€Ğ¸ Ğ¾Ğ±Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ğ¸ Ğº `/api/error`

---

## ğŸ“¸ Ğ¡ĞºÑ€Ğ¸Ğ½ÑˆĞ¾Ñ‚Ñ‹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹

### 1. Prometheus Targets - ServiceMonitor ÑĞ¾Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸

![Prometheus Targets](screenshots/01_prometheus_targets.png)

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:** ServiceMonitor ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶Ğ¸Ğ» Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ¸ ÑĞ¾Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸. Target `monitoring-app/monitoring-app-monitoring-app` Ğ² ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¸ **UP** (Ğ·ĞµĞ»Ñ‘Ğ½Ñ‹Ğ¹). Endpoint: `http://10.108.5.43:80/metrics`.

---

### 2. ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ app23_http_requests_total

![Query app23_requests](screenshots/02_prometheus_query_app23_total.png)

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:** Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ `app23_http_requests_total` Ñ Ğ¿Ñ€ĞµÑ„Ğ¸ĞºÑĞ¾Ğ¼ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ğ° 23. Ğ’Ğ¸Ğ´Ğ½Ñ‹ Ğ²ÑĞµ endpoints Ñ labels: `endpoint`, `method`, `status`.

---

### 3. PrometheusRule - 3 Ğ°Ğ»ĞµÑ€Ñ‚Ğ° Ğ¿Ğ¾ SLO

![Prometheus Rules](screenshots/03_prometheus_rules_alerts.png)

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:** Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ñ‹ 3 Ğ°Ğ»ĞµÑ€Ñ‚Ğ° ÑĞ¾Ğ³Ğ»Ğ°ÑĞ½Ğ¾ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸ÑĞ¼ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ğ° 23:
- **LowAvailability** (ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡Ğ½Ñ‹Ğ¹, severity: critical) - ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸ < 99.5%
- **HighErrorRate5xx** (Ğ¿Ñ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ğµ, severity: warning) - ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ¸ 5xx > 1% Ğ·Ğ° 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚
- **HighLatencyP95** (Ğ¿Ñ€ĞµĞ´ÑƒĞ¿Ñ€ĞµĞ¶Ğ´ĞµĞ½Ğ¸Ğµ, severity: warning) - ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¿Ñ€Ğ¸ p95 > 200ms

Ğ’ÑĞµ Ğ°Ğ»ĞµÑ€Ñ‚Ñ‹ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½Ñ‹ Ğ² Prometheus Ğ¸ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ñ‹ Ğº Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ñƒ.

---

### 4. ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ° app23_http_requests_total (Ğ´ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ²Ğ¸Ğ´)

![Query app23 raw](screenshots/04_prometheus_query_app23_raw.png)

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:** Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ²Ğ¸Ğ´ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ ÑÑ‡Ñ‘Ñ‚Ñ‡Ğ¸ĞºĞ° Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ñ Ñ€Ğ°Ğ·Ğ±Ğ¸Ğ²ĞºĞ¾Ğ¹ Ğ¿Ğ¾ Ğ²ÑĞµĞ¼ labels. Ğ’Ğ¸Ğ´Ğ½Ñ‹ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğº endpoints: `health`, `metrics`, `get_data`, `index`.

---

### 5. Rate Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ² ÑĞµĞºÑƒĞ½Ğ´Ñƒ

![Query rate](screenshots/05_prometheus_query_rate.png)

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:** Ğ“Ñ€Ğ°Ñ„Ğ¸Ğº `rate(app23_http_requests_total[1m])` Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¸Ğ½Ñ‚ĞµĞ½ÑĞ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ² ÑĞµĞºÑƒĞ½Ğ´Ñƒ. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ´Ğ»Ñ Ñ€Ğ°ÑÑ‡Ñ‘Ñ‚Ğ° Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾ÑÑ‚Ğ¸ Ğ¸ error rate Ğ² Ğ°Ğ»ĞµÑ€Ñ‚Ğ°Ñ….

---

### 6. Latency Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ - duration count

![Query duration](screenshots/06_prometheus_query_duration.png)

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:** ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ° `app23_http_request_duration_seconds_count` - ÑÑ‡Ñ‘Ñ‚Ñ‡Ğ¸Ğº Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ´Ğ»Ñ Ñ€Ğ°ÑÑ‡Ñ‘Ñ‚Ğ° Ğ¿ĞµÑ€Ñ†ĞµĞ½Ñ‚Ğ¸Ğ»ĞµĞ¹ latency. Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ Ğ² Ğ³Ğ¸ÑÑ‚Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğµ Ğ´Ğ»Ñ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ñ p95.

---

### 7. Kubernetes Ñ€ĞµÑÑƒÑ€ÑÑ‹ Ğ² namespace monitoring-app

![kubectl resources](screenshots/07_kubectl_resources.png)

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:** Ğ’Ñ‹Ğ²Ğ¾Ğ´ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹ `kubectl get all,servicemonitor,prometheusrule -n monitoring-app`. Ğ Ğ°Ğ·Ğ²Ñ‘Ñ€Ğ½ÑƒÑ‚Ñ‹ Ğ²ÑĞµ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ñ‹Ğµ Ñ€ĞµÑÑƒÑ€ÑÑ‹:
- **Deployment:** monitoring-app (2/2 READY)
- **Pods:** 2 Ñ€ĞµĞ¿Ğ»Ğ¸ĞºĞ¸ Ğ² ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¸ Running
- **Service:** ClusterIP Ğ½Ğ° Ğ¿Ğ¾Ñ€Ñ‚Ñƒ 80
- **ServiceMonitor:** Ğ´Ğ»Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğ³Ğ¾ ÑĞ±Ğ¾Ñ€Ğ° Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº
- **PrometheusRule:** Ñ 3 Ğ°Ğ»ĞµÑ€Ñ‚Ğ°Ğ¼Ğ¸

---

### 8. Grafana Explore - Dashboard Ñ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ°Ğ¼Ğ¸

![Grafana Explore](screenshots/08_grafana_explore_app23.png)

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:** Dashboard Ğ² Grafana Ğ¾Ñ‚Ğ¾Ğ±Ñ€Ğ°Ğ¶Ğ°ĞµÑ‚ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ `app23_http_requests_total` Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸. Grafana ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ° Ğº Prometheus Ğ¸ Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ. Ğ’Ğ¸Ğ´Ğ½Ñ‹ Ğ²ÑĞµ endpoints Ñ Ñ†Ğ²ĞµÑ‚Ğ¾Ğ²Ğ¾Ğ¹ ĞºĞ¾Ğ´Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¾Ğ¹.

---

### 9. Firing Alert - HighErrorRate5xx ÑÑ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ»

![Firing Alert](screenshots/09_prometheus_alert_firing.png)

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:** ĞĞ»ĞµÑ€Ñ‚ **HighErrorRate5xx** Ğ¿ĞµÑ€ĞµÑˆÑ‘Ğ» Ğ² ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ **Firing** (ĞºÑ€Ğ°ÑĞ½Ñ‹Ğ¹) Ğ¿Ğ¾ÑĞ»Ğµ Ğ³ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ 5xx Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº Ñ‡ĞµÑ€ĞµĞ· endpoint `/api/error`. ĞŸÑ€Ğ¾Ñ†ĞµĞ½Ñ‚ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº Ğ¿Ñ€ĞµĞ²Ñ‹ÑĞ¸Ğ» Ğ¿Ğ¾Ñ€Ğ¾Ğ³ 1% Ğ·Ğ° 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚ ÑĞ¾Ğ³Ğ»Ğ°ÑĞ½Ğ¾ ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ñ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ğ° 23. Ğ’Ğ¸Ğ´Ğ½Ğ¾ Ğ²Ñ€ĞµĞ¼Ñ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ°Ñ†Ğ¸Ğ¸ (Active Since) Ğ¸ Ñ‚ĞµĞºÑƒÑ‰ĞµĞµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ error rate.

**ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¹ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼ĞºĞ¸ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½:** "Ñ…Ğ¾Ñ‚Ñ Ğ±Ñ‹ Ğ¾Ğ´Ğ¸Ğ½ ÑÑ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ²ÑˆĞ¸Ğ¹/ÑĞ¸Ğ¼ÑƒĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¹ alert" âœ…

---

## ğŸ¯ Ğ¡Ğ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²Ğ¸Ğµ ĞºÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸ÑĞ¼ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼ĞºĞ¸

### âœ… ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ ĞºÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¸:

| ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¹ | Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ | ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ |
|----------|--------|---------------|
| ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ ÑĞ¾Ğ±Ğ¸Ñ€Ğ°ÑÑ‚ÑÑ | âœ… | Ğ¡ĞºÑ€Ğ¸Ğ½ÑˆĞ¾Ñ‚ #1 (Targets UP), #2-6 (Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº) |
| Ğ•ÑÑ‚ÑŒ Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ñ‹ | âœ… | Ğ¡ĞºÑ€Ğ¸Ğ½ÑˆĞ¾Ñ‚ #8 (Grafana), #2-6 (Prometheus Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸) |
| Ğ¡Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ğ²ÑˆĞ¸Ğ¹ alert | âœ… | Ğ¡ĞºÑ€Ğ¸Ğ½ÑˆĞ¾Ñ‚ #9 (HighErrorRate5xx Firing) |
| Helm chart Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¸Ñ‚ÑÑ | âœ… | Ğ¡ĞºÑ€Ğ¸Ğ½ÑˆĞ¾Ñ‚ #7 (kubectl resources), values.yaml, templates |
| Endpoint /metrics | âœ… | app.py Ñ prometheus_client, prefix app23_ |
| ServiceMonitor ÑĞ¾Ğ·Ğ´Ğ°Ğ½ | âœ… | templates/servicemonitor.yaml, ÑĞºÑ€Ğ¸Ğ½ÑˆĞ¾Ñ‚ #1 |
| PrometheusRule ÑĞ¾Ğ·Ğ´Ğ°Ğ½ | âœ… | templates/prometheusrule.yaml, ÑĞºÑ€Ğ¸Ğ½ÑˆĞ¾Ñ‚ #3 |
| 2-3 Ğ´Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ğ° | âœ… | Ğ“Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸: Availability, Latency, Error Rate |
| 1-2 Ğ°Ğ»ĞµÑ€Ñ‚Ğ° Ğ¿Ğ¾ SLO | âœ… | 3 Ğ°Ğ»ĞµÑ€Ñ‚Ğ°: LowAvailability, HighErrorRate5xx, HighLatencyP95 |

### âœ… Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¾:

- âœ… Helm chart Ñ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸ĞµĞ¹ (values.yaml)
- âœ… Templates: Deployment, Service, ServiceMonitor, PrometheusRule, _helpers.tpl
- âœ… ĞŸÑ€ĞµÑ„Ğ¸ĞºÑ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº app23_ (Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 23)
- âœ… SLO Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹: 99.5% availability, p95â‰¤200ms, 5xx>1%
- âœ… 2 Ñ€ĞµĞ¿Ğ»Ğ¸ĞºĞ¸ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ (high availability)
- âœ… Healthcheck endpoints
- âœ… Resource limits Ğ¸ probes
- âœ… ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ½Ğ°Ñ Ğ´Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°
- âœ… ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ñ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸ÑĞ¼Ğ¸

---

## ğŸ“š Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ°Ñ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ

### Observability (ĞĞ°Ğ±Ğ»ÑĞ´Ğ°ĞµĞ¼Ğ¾ÑÑ‚ÑŒ)

Ğ’ Ñ€Ğ°Ğ¼ĞºĞ°Ñ… Ğ´Ğ°Ğ½Ğ½Ğ¾Ğ¹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ñ‹ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ **Observability**:

**1. ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ (Metrics)**

- Prometheus ÑĞ¾Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¸Ğ· Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· endpoint `/metrics`
- ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ñ Ğ¿Ñ€ĞµÑ„Ğ¸ĞºÑĞ¾Ğ¼ `app23_` ÑĞ¾Ğ³Ğ»Ğ°ÑĞ½Ğ¾ Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ñƒ 23
- Counter: `app23_http_requests_total` - ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
- Histogram: `app23_http_request_duration_seconds` - Ğ²Ñ€ĞµĞ¼Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸

**2. Ğ”Ğ°ÑˆĞ±Ğ¾Ñ€Ğ´Ñ‹ (Dashboards)**

- Grafana Ğ²Ğ¸Ğ·ÑƒĞ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸
- 3 ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¾Ğ²: Availability, Latency, Error Rate
- PromQL Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ´Ğ»Ñ Ñ€Ğ°ÑÑ‡Ñ‘Ñ‚Ğ° SLO Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº

**3. ĞĞ»ĞµÑ€Ñ‚Ğ¸Ğ½Ğ³ (Alerting)**

- PrometheusRule Ñ 3 Ğ°Ğ»ĞµÑ€Ñ‚Ğ°Ğ¼Ğ¸ Ğ¿Ğ¾ SLO
- Alertmanager Ğ´Ğ»Ñ Ğ¼Ğ°Ñ€ÑˆÑ€ÑƒÑ‚Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğ¹
- Firing alert ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ ÑĞ¸Ğ¼ÑƒĞ»Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ (ÑĞºÑ€Ğ¸Ğ½ÑˆĞ¾Ñ‚ #9)

### OpenTelemetry

Ğ’ Ğ±ÑƒĞ´ÑƒÑ‰ĞµĞ¼ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ñ€Ğ°ÑÑˆĞ¸Ñ€Ğ¸Ñ‚ÑŒ observability Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑ OpenTelemetry Ğ´Ğ»Ñ:
- **Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ** - ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ»Ğ¾Ğ³Ğ¸ Ñ correlation ID
- **Ğ¢Ñ€Ğ°ÑÑĞ¸Ñ€Ğ¾Ğ²ĞºĞ°** - distributed tracing Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¼Ğ¸ĞºÑ€Ğ¾ÑĞµÑ€Ğ²Ğ¸ÑĞ°Ğ¼Ğ¸
- **Ğ£Ğ½Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ** - ĞµĞ´Ğ¸Ğ½Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ´Ğ»Ñ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº/Ğ»Ğ¾Ğ³Ğ¾Ğ²/Ñ‚Ñ€ĞµĞ¹ÑĞ¾Ğ²

### GitOps (Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾)

Ğ”Ğ»Ñ Ğ²Ğ½ĞµĞ´Ñ€ĞµĞ½Ğ¸Ñ GitOps Ñ Argo CD:

```yaml
# application.yaml
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: monitoring-app
  namespace: argocd
spec:
  project: default
  source:
    repoURL: https://github.com/alexsandro007/RSiOT-2025
    targetRevision: HEAD
    path: students/YarmolaAleksandr/task_04/src/helm/monitoring-app
  destination:
    server: https://kubernetes.default.svc
    namespace: monitoring-app
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
```

ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ° GitOps:
- Ğ”ĞµĞºĞ»Ğ°Ñ€Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ¾Ğµ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¾Ğ¹
- Git ĞºĞ°Ğº ĞµĞ´Ğ¸Ğ½ÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğ¹ Ğ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº Ğ¸ÑÑ‚Ğ¸Ğ½Ñ‹
- ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸ÑÑ…
- Rollback Ñ‡ĞµÑ€ĞµĞ· Git history

### Ğ¢Ğ¸Ğ¿Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ Ğ¸ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° 1: ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ½Ğµ ÑĞ¾Ğ±Ğ¸Ñ€Ğ°ÑÑ‚ÑÑ**

```bash
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ ServiceMonitor
kubectl get servicemonitor -n monitoring-app -o yaml

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ targets Ğ² Prometheus
kubectl port-forward svc/monitoring-kube-prometheus-prometheus 9090:9090 -n monitoring
# ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ: http://localhost:9090/targets
```

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° 2: ĞĞ»ĞµÑ€Ñ‚Ñ‹ Ğ½Ğµ ÑÑ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ÑÑ‚**

```bash
# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ PrometheusRule
kubectl get prometheusrule -n monitoring-app -o yaml

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ğ°Ğ»ĞµÑ€Ñ‚Ñ‹ Ğ² Prometheus
# http://localhost:9090/alerts

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Alertmanager
kubectl logs -l app.kubernetes.io/name=alertmanager -n monitoring
```

**ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° 3: Helm chart Ğ½Ğµ Ğ´ĞµĞ¿Ğ»Ğ¾Ğ¸Ñ‚ÑÑ**

```powershell
# Ğ›Ğ¸Ğ½Ñ‚Ğ¸Ğ½Ğ³ Ñ‡Ğ°Ñ€Ñ‚Ğ°
helm lint ./src/helm/monitoring-app

# Dry-run
helm install monitoring-app ./src/helm/monitoring-app `
  --namespace monitoring-app `
  --create-namespace `
  --dry-run --debug

# ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ values
helm template monitoring-app ./src/helm/monitoring-app | kubectl apply --dry-run=client -f -
```
