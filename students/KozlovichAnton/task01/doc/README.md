# Лабораторная работа №1: Контейнеризация и Docker в РСиОТ

## Введение в проект

Этот проект реализует простой веб-сервис на базе Node.js и фреймворка Express, который взаимодействует с базой данных Redis. Сервис включает в себя несколько эндпоинтов для проверки состояния и корректного завершения работы. Приложение упаковано в Docker-контейнеры с использованием многоэтапной сборки, что обеспечивает эффективное развертывание и масштабирование на разных платформах. Основная зависимость - клиент Redis для хранения и обработки данных.

## Структура проекта

- src/: Содержит исходный код приложения, включая главный файл сервера (server.js) и файл зависимостей (package.json).
- Dockerfile: Определяет многослойный процесс сборки Docker-образа для оптимизации размера и безопасности.
- .dockerignore: Исключает ненужные файлы из контекста сборки, ускоряя процесс.
- docker-compose.yml: Конфигурация для оркестрации сервисов, включая приложение и Redis, с сетевыми настройками.
- README.md: Подробное руководство по установке, запуску и использованию проекта.

## Требования к системе

Для успешного запуска проекта необходимо наличие следующих инструментов:
- Docker (версия 20.10 или выше)
- Docker Compose (версия 1.29 или выше)

## Пошаговая инструкция по запуску

### Запуск через Docker Compose

1. Клонируйте репозиторий и перейдите в корневую директорию проекта.
2. Выполните команду для сборки и запуска сервисов:

```bash
docker-compose up --build
```

3. После успешной сборки приложение будет доступно по адресу http://localhost:8093.

### Ручная сборка Docker-образа

Если вы предпочитаете ручное управление:
1. Соберите образ:

```bash
docker build -t custom-node-server .
```

2. Запустите контейнер:

```bash
docker run -p 8093:8093 custom-node-server
```

3. Проверьте доступность сервиса в браузере или через curl.

## Архитектура проекта

Проект построен по микросервисной архитектуре с разделением ответственности:
- Веб-сервер: Обрабатывает HTTP-запросы с помощью Express.
- База данных: Redis используется для кэширования и хранения временных данных.
- Контейнеризация: Docker обеспечивает изоляцию и переносимость.
- Оркестрация: Docker Compose управляет взаимодействием между сервисами.

## Документация API

### Эндпоинты

- GET /ready: Проверяет готовность сервиса к работе. Возвращает статус "OK" при успешной проверке. Этот маршрут полезен для health checks в системах мониторинга.
- GET /health: Дополнительный маршрут для проверки здоровья приложения, включая статус подключения к Redis.

### Примеры использования

```bash
curl http://localhost:8093/ready
```

# Ожидаемый ответ: OK

```bash
curl http://localhost:8093/health
```

# Ожидаемый ответ: {"status": "healthy", "redis": "connected"}

## Graceful Shutdown

Приложение поддерживает корректное завершение работы при получении сигналов SIGINT (Ctrl+C) или SIGTERM. В этом случае:
1. Сервер прекращает прием новых запросов.
2. Завершаются активные соединения с Redis.
3. Выводятся информационные сообщения в консоль: "Начинается завершение работы сервера..." и "Соединение с Redis закрыто".

## Устранение неполадок

- Проблема: Сервис не запускается. Решение: Проверьте, что порты 8093 и 6379 свободны, и Docker запущен.
- Проблема: Ошибка подключения к Redis. Решение: Убедитесь, что контейнер Redis здоров (проверьте логи через docker-compose logs redis).
- Проблема: Медленная сборка. Решение: Убедитесь, что .dockerignore правильно настроен.

## Информация о студенте

ФИО: Козлович Антон Александрович  
Группа: as-63  
Номер зачетки: 220011  
Электронная почта: AS006308@g.bstu.by  
GitHub: Anton777kozlovich  
Вариант задания: 07  
Дата выполнения: 12.10.2025  
ОС: Windows 10 Pro 22H2, Ubuntu 22.04  
Версия Docker: Docker Desktop 4.45.0 / Engine 28.3.3git
