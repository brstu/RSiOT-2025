---
apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: web05-alerts
  namespace: app05
  labels:
    app: web05
    release: monitoring
spec:
  groups:
  - name: web05-slo
    rules:
    - alert: HighErrorRate
      expr: |
        sum(rate(app05_http_errors_total[15m]))
        / sum(rate(app05_http_requests_total[15m]))
        * 100 > 2.0
      for: 5m
      labels:
        severity: critical
        student: "220008"
        variant: "05"
      annotations:
        summary: "Error rate above 2%"
        description: "Error rate is {{ $value }}% for application web05"

    - alert: HighLatency
      expr: |
        histogram_quantile(0.95,
          sum(rate(app05_http_request_duration_seconds_bucket[5m]))
          by (le, endpoint)
        ) > 0.3
      for: 5m
      labels:
        severity: warning
        student: "220008"
        variant: "05"
      annotations:
        summary: "P95 latency above 300ms"
        description: "P95 latency is {{ $value }}s for application web05"
